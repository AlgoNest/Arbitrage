<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crypto Arbitrage Table</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 13px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #222; color: #fff; position: sticky; top: 0; }
    .profit { background: #d4edda; color: #155724; font-weight: bold; }
    .loss { background: #f8d7da; color: #721c24; }
  </style>
</head>
<body>
  <h2>Crypto Arbitrage Opportunities</h2>
  <table>
    <thead>
      <tr>
        <th>Coin</th>
        <th>Binance</th>
        <th>Kraken</th>
        <th>Coinbase</th>
        <th>Huobi</th>
        <th>Gate.io</th>
        <th>MEXC</th>
        <th>KuCoin</th>
        <th>Bybit</th>
        <th>Spread %</th>
        <th>Best Buy</th>
        <th>Best Sell</th>
      </tr>
    </thead>
    <tbody id="prices"></tbody>
  </table>

  <script>
    // 70+ coins (Top + small caps for arbitrage chances)
    const coins = [
      "BTC","ETH","BNB","XRP","ADA","DOGE","SOL","DOT","MATIC","TON",
      "SHIB","TRX","APT","ARB","SUI","PEPE","FLOKI","INJ","OP","XLM",
      "AVAX","LTC","NEAR","ATOM","FIL","AAVE","EOS","ETC","XMR","XTZ",
      "SAND","MANA","RUNE","KSM","DASH","ENJ","ZIL","CHZ","CRO","FTM",
      "DYDX","CFX","GMX","WOO","1INCH","LRC","CELR","ANKR","CVC","NKN",
      "OCEAN","STORJ","VET","ICX","ONT","ZRX","REN","BAL","KAVA","MTL",
      "BAND","SYS","BAT","HOT","SC","AR","YFI","UNI","GRT","SNX","COMP",
      "ALGO","EGLD","RVN","QTUM","MASK","LUNA","LPT","SRM","CEL","API3",
      "CRV","SXP","BCH","COTI","RAY","BEL","KDA","AMP","ILV","STX","JOE"
    ];

    const exchanges = {
      binance: s => `https://api.binance.com/api/v3/ticker/price?symbol=${s}USDT`,
      kraken: s => `https://api.kraken.com/0/public/Ticker?pair=${s}USDT`,
      coinbase: s => `https://api.coinbase.com/v2/prices/${s}-USD/spot`,
      huobi: s => `https://api.huobi.pro/market/detail/merged?symbol=${s.toLowerCase()}usdt`,
      gate: s => `https://api.gateio.ws/api/v4/spot/tickers?currency_pair=${s}_USDT`,
      mexc: s => `https://api.mexc.com/api/v3/ticker/price?symbol=${s}USDT`,
      kucoin: s => `https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=${s}-USDT`,
      bybit: s => `https://api.bybit.com/v2/public/tickers?symbol=${s}USDT`
    };

    async function fetchPrice(exchange, coin) {
      try {
        let url = exchanges[exchange](coin);
        let res = await fetch(url);
        let data = await res.json();

        switch (exchange) {
          case "binance": return parseFloat(data.price);
          case "kraken": return parseFloat(Object.values(data.result)[0].c[0]);
          case "coinbase": return parseFloat(data.data.amount);
          case "huobi": return parseFloat(data.tick.close);
          case "gate": return parseFloat(data[0].last);
          case "mexc": return parseFloat(data.price);
          case "kucoin": return parseFloat(data.data.price);
          case "bybit": return parseFloat(data.result[0].last_price);
        }
      } catch {
        return null;
      }
    }

    function makeRow(coin) {
      return `
        <tr id="row-${coin}">
          <td>${coin}</td>
          <td id="${coin}-binance">--</td>
          <td id="${coin}-kraken">--</td>
          <td id="${coin}-coinbase">--</td>
          <td id="${coin}-huobi">--</td>
          <td id="${coin}-gate">--</td>
          <td id="${coin}-mexc">--</td>
          <td id="${coin}-kucoin">--</td>
          <td id="${coin}-bybit">--</td>
          <td id="${coin}-spread">--</td>
          <td id="${coin}-buy">--</td>
          <td id="${coin}-sell">--</td>
        </tr>
      `;
    }

    async function initTable() {
      const tbody = document.getElementById("prices");
      tbody.innerHTML = coins.map(makeRow).join("");
    }

    async function updatePrices() {
      let spreads = [];

      for (let coin of coins) {
        let prices = {};

        for (let ex of Object.keys(exchanges)) {
          let price = await fetchPrice(ex, coin);
          let cell = document.getElementById(`${coin}-${ex}`);
          if (price) {
            cell.textContent = price.toFixed(4);
            prices[ex] = price;
          } else {
            cell.textContent = "N/A";
          }
        }

        let spreadCell = document.getElementById(`${coin}-spread`);
        let buyCell = document.getElementById(`${coin}-buy`);
        let sellCell = document.getElementById(`${coin}-sell`);

        let validPrices = Object.values(prices);
        if (validPrices.length > 1) {
          let minEx = Object.keys(prices).reduce((a, b) => prices[a] < prices[b] ? a : b);
          let maxEx = Object.keys(prices).reduce((a, b) => prices[a] > prices[b] ? a : b);

          let spread = (prices[maxEx] - prices[minEx]) / prices[minEx] * 100;
          spreadCell.textContent = spread.toFixed(2) + "%";
          spreadCell.className = spread > 1 ? "profit" : "loss";

          buyCell.textContent = `${minEx} @ ${prices[minEx].toFixed(4)}`;
          sellCell.textContent = `${maxEx} @ ${prices[maxEx].toFixed(4)}`;

          spreads.push({ coin, spread });
        } else {
          spreadCell.textContent = "--";
          buyCell.textContent = "--";
          sellCell.textContent = "--";
        }
      }

      // Auto-sort table by highest spread
      spreads.sort((a, b) => b.spread - a.spread);
      const tbody = document.getElementById("prices");
      spreads.forEach(({ coin }) => {
        tbody.appendChild(document.getElementById(`row-${coin}`));
      });
    }

    initTable();
    updatePrices();
    setInterval(updatePrices, 15000); // refresh every 15s
  </script>
</body>
</html>
